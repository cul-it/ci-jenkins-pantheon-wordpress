var FileBird_Media={init:function(){var e=jQuery("#filebird_sidebar").html();jQuery("#filebird_sidebar").remove(),jQuery("#wpbody").prepend(e);var n=240;jQuery(".panel-left").fileBirdResizable({handleSelector:".njt-splitter",resizeHeight:!1,onDrag:function(e,t,i,r,a){0===Object.keys(wp.media.frames).length&&wp.media.frames.constructor===Object||window.wp.media.frames.browse.browserView.attachments.setColumns(),n=i;var o=e.pageX-t.offset().left;return i<240?!(o>200)&&(FileBird_Media.sidebarResize.init(-18),t.css("max-width","0"),t.css("overflow","hidden"),jQuery(".njt-splitter").hide(),jQuery("#wpbody > .njt-expand").length||jQuery("#wpbody").prepend("<span class='njt-expand'></span>"),setTimeout(function(){jQuery(".njt-expand").show()},600),jQuery(".njt-expand").on("click",function(){jQuery(this).hide(),jQuery(".filebird_sidebar_container").css({"max-width":"800px",width:"240px"}),jQuery(".njt-splitter").show(),FileBird_Media.sidebarResize.init(240)}),!1):(i>240&&i<800&&jQuery(".njt-splitter").is(":visible")&&(FileBird_Media.sidebarResize.init(i),t.css("overflow","initial")),!(i>=800)&&void 0)},onDragEnd:function(e){var t={action:"filebird_ajax_save_splitter",nonce:window.njt_fb_nonce,splitter_width:n};n<240&&(t.splitter_width=240),n>800&&(t.splitter_width=800),(jQuery(".njt-splitter").is(":visible")||n<240)&&jQuery.post(ajaxurl,t,function(e){}).success(function(e){1!=e.success&&console.log("Error: "+e)})}}),DhTreeFolder.init(),FileBird_Search_Sort.init()},sidebarResize:{init:function(e){var n="width: calc(100% - "+(e+18)+"px)";jQuery("#njtfb-resize").length?jQuery("#njtfb-resize > style").text("#wpbody-content { "+n+"}").appendTo("#njtfb-resize"):(jQuery('<div id="njtfb-resize" style="display: none"></div>').appendTo("body"),jQuery("<style>").text("#wpbody-content { "+n+"}").appendTo("#njtfb-resize"))}},jstree:{init:function(){FileBird_Media.jstree.default(),"undefined"!==localStorage.getItem("current_folder")&&null!=localStorage.getItem("current_folder")||jQuery("#menu-item-all .jstree-anchor").trigger("click")},default:function(){jQuery("#njt-filebird-defaultTree").length&&jQuery("ul.jstree-container-ul li.menu-item").on("click",function(){var e=jQuery(this).attr("data-id");if(localStorage.setItem("current_folder",e),jQuery("ul.jstree-container-ul li.menu-item.current-dir").removeClass("current-dir"),jQuery(this).addClass("current-dir"),jQuery(".jstree-anchor.need-refresh").length){var n=jQuery(".filebird_sidebar"),t=ntWMC.ntWMCgetBackboneOfMedia(n);if(t.browser.length>0&&"object"==typeof t.view)try{t.view.collection.props.set({ignore:+new Date})}catch(e){console.log(e)}else window.location.reload();jQuery(".jstree-anchor.need-refresh").removeClass("need-refresh")}jQuery(".wpmediacategory-filter").val(e),jQuery(".wpmediacategory-filter").trigger("change"),jQuery(".menu-item.current_folder").length&&(jQuery('select[name="njt_filebird_folder"]').length||jQuery(".menu-item.current_folder").removeClass("current_folder"))})}},sweetAlert:{delete:function(e){var n=0;n=Array.isArray(e)?e[0].data("id"):e.data("id");var t=jQuery("#menu-item-"+n);jQuery(t).next().find(".menu-item-data-parent-id").length&&jQuery(t).next().find(".menu-item-data-parent-id").val()==n?swal({title:filebird_translate.oops,text:filebird_translate.folder_are_sub_directories,type:"error"}):swal({title:filebird_translate.are_you_sure,text:filebird_translate.not_able_recover_folder,type:"warning",confirmButtonText:filebird_translate.yes_delete_it,showCancelButton:!0,cancelButtonText:filebird_translate.cancel}).then(function(e){e.value&&(njt_trigger_folder.delete(n),FileBird_Media.message.show("success",filebird_translate.folder_deleted))})}},toolbar:{init:function(){FileBird_Media.toolbar.rename(),FileBird_Media.toolbar.delete()},rename:function(){jQuery(".js__nt_rename").length&&jQuery(".js__nt_rename").on("click",function(){if(jQuery(".folder-input").length)return jQuery(".folder-input").focus(),(n=jQuery(".folder-input")).putCursorAtEnd().on("focus",function(){n.putCursorAtEnd()}),!1;var e=jQuery(".menu-item.current_folder");if(e.length){var n,t=e.find(".menu-item-data-db-id").val(),i=e.find(".menu-item-title").text(),r=e.menuItemDepth(),a=api.editFolderFormTemplate(t,i,"menu-item-depth-"+r);jQuery(a).insertAfter(e),e.hide(),jQuery(".edit-folder-name").focus(),(n=jQuery(".edit-folder-name")).putCursorAtEnd().on("focus",function(){n.putCursorAtEnd()})}})},delete:function(){jQuery(".js__nt_delete").length&&jQuery(".js__nt_delete").on("click",function(){var e=jQuery("#njt-filebird-folderTree .current_folder");if(!e.length)return!1;FileBird_Media.sweetAlert.delete(e)})}},tooltip:{init:function(e){jQuery(".menu-item-bar").bind({mouseenter:function(){var n=jQuery(this),t=n.find(".item-title").innerWidth(),i=n.find(".menu-item-title").innerWidth(),r=n.find(".menu-item-title").text();t<i&&tippy(n[0],{content:r,sticky:!0,offset:e.offset,arrow:!0,zIndex:99999999,maxWidth:e.maxWidth})}})}},dropdown:{init:function(){jQuery.contextMenu({selector:".njt-filebird-dropdown",zIndex:999999,callback:function(e,n){"asc"!=e&&"desc"!=e||(jQuery(".njt-filebird-search input").val().trim()?alert("Please don't sort folder when you are searching!"):(FileBird_Search_Sort.sort(e),setTimeout(()=>{njt_trigger_folder.update_folder_position()},500)))},trigger:"left",items:{asc:{name:filebird_translate.sort_asc,icon:"context-menu-icon context-menu-icon-sort-asc"},desc:{name:filebird_translate.sort_desc,icon:"context-menu-icon context-menu-icon-sort-desc"}}})}},message:{show:function(e,n){var t=null;if(successIcon={icon:' <i aria-label="icon: check-circle" class="anticon anticon-check-circle">\n        <svg viewBox="64 64 896 896" data-icon="check-circle" width="1em" height="1em" fill="currentColor" aria-hidden="true" focusable="false" class="">\n        <path d="M512 64C264.6 64 64 264.6 64 512s200.6 448 448 448 448-200.6 448-448S759.4 64 512 64zm193.5 301.7l-210.6 292a31.8 31.8 0 0 1-51.7 0L318.5 484.9c-3.8-5.3 0-12.7 6.5-12.7h46.9c10.2 0 19.9 4.9 25.9 13.3l71.2 98.8 157.2-218c6-8.3 15.6-13.3 25.9-13.3H699c6.5 0 10.3 7.4 6.5 12.7z"></path></svg></i>\n      ',attr:"ant-message-success"},errorIcon={icon:'<i aria-label="icon: check-circle" class="anticon anticon-check-circle">\n        <svg viewBox="64 64 896 896" data-icon="check-circle" width="1em" height="1em" fill="currentColor" aria-hidden="true" focusable="false" class="">\n        <path d="M512 64C264.6 64 64 264.6 64 512s200.6 448 448 448 448-200.6 448-448S759.4 64 512 64zm193.5 301.7l-210.6 292a31.8 31.8 0 0 1-51.7 0L318.5 484.9c-3.8-5.3 0-12.7 6.5-12.7h46.9c10.2 0 19.9 4.9 25.9 13.3l71.2 98.8 157.2-218c6-8.3 15.6-13.3 25.9-13.3H699c6.5 0 10.3 7.4 6.5 12.7z"></path></svg></i>\n      ',attr:"ant-message-error"},warningIcon={icon:'<i aria-label="icon: exclamation-circle" class="anticon anticon-exclamation-circle">\n        <svg viewBox="64 64 896 896" data-icon="exclamation-circle" width="1em" height="1em" fill="currentColor" aria-hidden="true" focusable="false" class="">\n        <path d="M512 64C264.6 64 64 264.6 64 512s200.6 448 448 448 448-200.6 448-448S759.4 64 512 64zm-32 232c0-4.4 3.6-8 8-8h48c4.4 0 8 3.6 8 8v272c0 4.4-3.6 8-8 8h-48c-4.4 0-8-3.6-8-8V296zm32 440a48.01 48.01 0 0 1 0-96 48.01 48.01 0 0 1 0 96z"></path></svg></i>\n      ',attr:"ant-message-warning"},"success"==e)t=successIcon;else if("error"==e)t=errorIcon;else{if("warning"!=e)return;t=warningIcon}var i=`\n      <div class="njt-ant-message">\n        <div class="ant-message">\n        <span><div class="ant-message-notice">\n            <div class="ant-message-notice-content">\n              <div class="ant-message-custom-content ${t.attr}">\n                ${t.icon}\n                <span>${n}</span>\n              </div>\n            </div>\n        </div></span>\n        </div>\n        <style>\n        .ant-message {\n          box-sizing: border-box;\n          margin: 0;\n          padding: 0;\n          color: rgba(0, 0, 0, 0.65);\n          font-size: 14px;\n          font-variant: tabular-nums;\n          line-height: 1.5;\n          list-style: none;\n          font-feature-settings: 'tnum';\n          position: fixed;\n          top: 40px;\n          left: 0;\n          z-index: 999999999;\n          width: 100%;\n          pointer-events: none;\n        }\n        .ant-message-notice {\n          padding: 8px;\n          text-align: center;\n        }\n        .ant-message-notice:first-child {\n          margin-top: -8px;\n        }\n        .ant-message-notice-content {\n          display: inline-block;\n          padding: 10px 16px;\n          background: #fff;\n          border-radius: 4px;\n          box-shadow: 0 4px 12px rgba(0, 0, 0, 0.15);\n          pointer-events: all;\n        }\n        .ant-message-success .anticon {\n          color: #52c41a;\n        }\n        .ant-message-error .anticon {\n          color: #f5222d;\n        }\n        .ant-message-warning .anticon {\n          color: #faad14;\n        }\n        .ant-message-info .anticon,\n        .ant-message-loading .anticon {\n          color: #1890ff;\n        }\n        .ant-message .anticon {\n          position: relative;\n          top: 3px;\n          margin-right: 8px;\n          font-size: 16px;\n        }\n        .ant-message-notice.move-up-leave.move-up-leave-active {\n          overflow: hidden;\n          -webkit-animation-name: MessageMoveOut;\n                  animation-name: MessageMoveOut;\n          -webkit-animation-duration: 0.3s;\n                  animation-duration: 0.3s;\n        }\n        @-webkit-keyframes MessageMoveOut {\n          0% {\n            max-height: 150px;\n            padding: 8px;\n            opacity: 1;\n          }\n          100% {\n            max-height: 0;\n            padding: 0;\n            opacity: 0;\n          }\n        }\n        @keyframes MessageMoveOut {\n          0% {\n            max-height: 150px;\n            padding: 8px;\n            opacity: 1;\n          }\n          100% {\n            max-height: 0;\n            padding: 0;\n            opacity: 0;\n          }\n        }\n        </style>\n      </div>\n      `;jQuery("body").append(i),jQuery(".njt-ant-message").hide().show("slow"),this.hide(2e3)},hide:function(e){setTimeout(()=>{jQuery(".njt-ant-message").fadeOut(300,function(){jQuery(".njt-ant-message").remove()})},e)}}};