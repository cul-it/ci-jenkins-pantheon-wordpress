var nt_wcm_post_folder_id=-1;setInterval(function(){jQuery(".njt-filebird-editcategory-filter").off("change").on("change",function(e){if(void 0!==e.originalEvent){var t=jQuery("div[id^='__wp-uploader-id-'].supports-drag-drop:visible .njt-filebird-editcategory-filter");nt_wcm_post_folder_id=Number(jQuery(t).val())}});var e=jQuery(".media-toolbar-secondary .wpmediacategory-filter"),t=jQuery(".njt-filebird-editcategory-filter");e.length&&t.length&&e.on("change",function(){t.val(e.val()),t.trigger("change"),nt_wcm_post_folder_id=Number(e.val())})},1e3),jQuery(document).ready(function(){var e=window.wp;void 0!==e&&"function"==typeof e.Uploader&&jQuery.extend(e.Uploader.prototype,{progress:function(){},init:function(){this.uploader&&(this.uploader.bind("FileFiltered",function(e,t){}),this.uploader.bind("BeforeUpload",function(e,t){var n=nt_wcm_post_folder_id,r=e.settings.multipart_params;Number.isInteger(n)&&n>0&&(r.ntWMCFolder=n)}),this.uploader.bind("UploadProgress",function(e,t){jQuery(".uploader-window").hide().css("opacity",0),ntWMC.filebird_begin_loading()}),this.uploader.bind("UploadComplete",function(e,t){ntWMC.filebird_finish_loading(),jQuery('.menu-item[data-id="'+nt_wcm_post_folder_id+'"] .jstree-anchor').trigger("click")}),this.uploader.bind("FilesAdded",function(e,t){var n=nt_wcm_post_folder_id,r=jQuery('.menu-item[data-id="'+n+'"] .jstree-anchor'),i=jQuery(".menu-item[data-id=-1] .jstree-anchor"),a=jQuery('.menu-item[data-id="all"] .jstree-anchor');t.forEach(function(e){ntWMC.updateCount(null,n),"all"===n?(i.addClass("need-refresh"),ntWMC.updateCount(null,-1)):-1===Number(n)?(a.addClass("need-refresh"),ntWMC.updateCount(null,"all")):(r.addClass("need-refresh"),ntWMC.updateCount(null,"all"))})}))}})}),jQuery(document).ajaxSend(function(e,t,n){try{if(n.data.indexOf("action=delete-post")>-1){var r=n.context.id;jQuery.ajax({type:"POST",dataType:"json",data:{id:r,action:"nt_wcm_get_terms_by_attachment",nonce:window.njt_fb_nonce},url:ajaxurl,success:function(e){var t=Array.from(e.data,e=>e.term_id);t.length&&jQuery("#filebird_terms").val(t.join())}})}}catch(e){}}.bind(this)),jQuery(document).ajaxComplete(function(e,t,n){try{if(n.data.indexOf("action=delete-post")>-1){var r=nt_wcm_post_folder_id,i=jQuery("#filebird_terms").val();if(i){var a=i.split(",");jQuery.each(a,function(e,t){ntWMC.updateCount(t,null)})}else"all"!==r||i||ntWMC.updateCount(-1,null);-1===Number(r)&&ntWMC.updateCount(-1,null),ntWMC.updateCount("all",null)}}catch(e){}}.bind(this)),jQuery(document).ajaxComplete(function(e,t,n){try{if("add-nt_wmc_folder"===n.action){var r=-1;setTimeout(()=>{if(jQuery("[name='tax_input[nt_wmc_folder][]']").each(function(){var e=parseInt(jQuery(this).val());r=e>r?e:r}),r>0){var e={action:"filebird_ajax_update_folder_list",type:"new_edit_attachment",folder_type:"default",term_id:r,nonce:window.njt_fb_nonce};jQuery.post(ajaxurl,e,function(e){"error"==e&&console.log("error insert")}).fail(function(){console.log("error insert")}).success(function(e){console.log(e)})}},300)}}catch(e){}}.bind(this));